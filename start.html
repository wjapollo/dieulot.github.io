<!doctype html>
<meta charset="utf-8">
<title>InstantClick: Getting started</title>
<meta name="viewport" content="width=720">
<meta name="description" content="Get started with InstantClick.">
<link rel="stylesheet" href="style-4.css">
<body>
<div id="header">
  <h1><a href=".">InstantClick</a></h1>
  <ul>
    <li class="github"><a href="https://github.com/dieulot/instantclick" title="GitHub">Github</a>
    <li class="twitter"><a href="https://twitter.com/instantclickjs" title="Twitter">Twitter</a>
    <li><a href=".">Home</a>
    <li class="on"><a href="start.html">Getting started</a>
    <li><a href="click-test.html">Click test</a>
    <li><a href="changelog.html">Changelog</a>
  </ul>
</div>
<h2>Getting started</h2>

<p>Grab InstantClick 2.1 <small>(2014/02/09)</small>.

<table id="downloads">
  <tr>
    <td><a href="instantclick.min.js?2.1" class="btn btn-big" download>Production version<br><small>minified + gzipped, 1.6kb</small></a>
    <td><a href="https://raw.github.com/dieulot/instantclick/v2.1/instantclick.js" class="btn" download>Development version<br><small>Full sources, 10.4kb</small></a>
</table>

<p class="warning"><strong>Upgrading from 2.0?</strong> Starting with 2.1 blacklisting is now <a href="#blacklisting">the default</a>.

<h3 id="preloading">Preloading</h3>

<h4 id="hover">On hover</h4>

<p>Preloading kicks in when a user hovers over a link. If the user has a decent connection and your pages don’t take too long to be served, pages will display instantly.

<p>Include InstantClick and initialize it near the end of your pages:

<div id="gist8879571" class="gist">
<div class="gist-file">
<div class="gist-data gist-syntax">
<div class="file-data">
<table cellpadding="0" cellspacing="0" class="lines highlight">
<tr>
<td class="line-numbers">
<span class="line-number" id="file-gistfile1-html-L1" rel="file-gistfile1-html-L1">1</span>
<span class="line-number" id="file-gistfile1-html-L2" rel="file-gistfile1-html-L2">2</span>
<span class="line-number" id="file-gistfile1-html-L3" rel="file-gistfile1-html-L3">3</span>
<span class="line-number" id="file-gistfile1-html-L4" rel="file-gistfile1-html-L4">4</span>
<span class="line-number" id="file-gistfile1-html-L5" rel="file-gistfile1-html-L5">5</span>
</td>
<td class="line-data">
<pre class="line-pre"><div class="line" id="file-gistfile1-html-LC1">...</div><div class="line" id="file-gistfile1-html-LC2"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;instantclick.min.js&quot;</span> <span class="na">data-no-instant</span><span class="nt">&gt;&lt;/script&gt;</span></div><div class="line" id="file-gistfile1-html-LC3"><span class="nt">&lt;script </span><span class="na">data-no-instant</span><span class="nt">&gt;</span><span class="nx">InstantClick</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span><span class="nt">&lt;/script&gt;</span></div><div class="line" id="file-gistfile1-html-LC4"><span class="nt">&lt;/body&gt;</span></div><div class="line" id="file-gistfile1-html-LC5"><span class="nt">&lt;/html&gt;</span></div></pre>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>

<p>Then, head over to <a href="#blacklisting">Blacklisting (or whitelisting) links</a> to know what not to preload.

<h4 id="delay">On hover after a delay</h4>

<p>If the user is still hovering over a link after a delay of your choice has passed, the page will start preloading.

<p>Recommended delays are 100 ms and 50 ms. More than 100 ms may actually be worse than on mousedown (below), less than 50 ms likely won’t be perceptible.

<p>To make InstantClick preload after a delay, pass the delay in milliseconds as an argument to <code>InstantClick.init</code>.

<div id="gist8879571" class="gist">
<div class="gist-file">
<div class="gist-data gist-syntax">
<div class="file-data">
<table cellpadding="0" cellspacing="0" class="lines highlight">
<tr>
<td class="line-numbers">
<span class="line-number" id="file-gistfile1-js-L1" rel="file-gistfile1-js-L1">1</span>
</td>
<td class="line-data">
<pre class="line-pre"><div class="line" id="file-gistfile1-js-LC1"><span class="nx">InstantClick</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span></div></pre>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>

<h4 id="mousedown">On mousedown</h4>

<p>Preload when the user presses his mouse button (the click happens on release). This brings nearly zero overhead to your server and still bring a “magical” speed boost.

<p>To use, pass <code>'mousedown'</code> as an argument to <code>InstantClick.init</code>.

<div id="gist8879571" class="gist">
<div class="gist-file">
<div class="gist-data gist-syntax">
<div class="file-data">
<table cellpadding="0" cellspacing="0" class="lines highlight">
<tr>
<td class="line-numbers">
<span class="line-number" id="file-gistfile1-js-L1" rel="file-gistfile1-js-L1">1</span>
</td>
<td class="line-data">
<pre class="line-pre"><div class="line" id="file-gistfile1-js-LC1"><span class="nx">InstantClick</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="s1">&#39;mousedown&#39;</span><span class="p">);</span></div></pre>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>

<h3 id="blacklisting">Blacklisting (or whitelisting) links</h3>

<p class="warning">Before InstantClick 2.1, passing a <code>true</code> argument would enable <strong>blacklisting</strong>. Blacklisting is now the default. Passing <code>true</code> now enables <strong>whitelisting</strong>.

<p>You can restrict what links InstantClick preloads by either blacklisting (default) or whitelisting them.

<p>In general, you’ll use blacklisting when you start a website from scratch, or when your website consists of only a few pages; you’ll use whitelisting when your website is already done and complex.

<p>What to blacklist, and to NOT whitelist:

<ul>
  <li>Links pointing to an action, such as delete and logout links.
  <li>Links pointing to non-HTML content that takes a while to load.
  <li>Links pointing to a page with different styles/scripts in the <code>&lt;head&gt;</code>.
</ul>

<p>Some links won’t be preloaded and cannot be whitelisted:

<ul>
  <li>Links with a <code>target</code> or <code>download</code> attribute.
  <li>Links with a different domain or protocol.
  <li>Links pointing to an #anchor on the same page.
</ul>

<h4 id="black">Blacklisting</h4>

<p>All your website’s links will be preloadable by default.

<p>To blacklist a link, add it a <code>data-no-instant</code> attribute.

<div id="gist8879571" class="gist">
<div class="gist-file">
<div class="gist-data gist-syntax">
<div class="file-data">
<table cellpadding="0" cellspacing="0" class="lines highlight">
<tr>
<td class="line-numbers">
<span class="line-number" id="file-gistfile1-html-L1" rel="file-gistfile1-html-L1">1</span>
</td>
<td class="line-data">
<pre class="line-pre"><div class="line" id="file-gistfile1-html-LC1"><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;/blog/&quot;</span> <span class="na">data-no-instant</span><span class="nt">&gt;</span>Blog<span class="nt">&lt;/a&gt;</span></div></pre>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>

<h4 id="white">Whitelisting</h4>

<p>With whitelisting, no links will get preloaded by default.

<p>To enable whitelisting, pass a <code>true</code> argument to <code>InstantClick.init</code>.

<div id="gist8879571" class="gist">
<div class="gist-file">
<div class="gist-data gist-syntax">
<div class="file-data">
<table cellpadding="0" cellspacing="0" class="lines highlight">
<tr>
<td class="line-numbers">
<span class="line-number" id="file-gistfile1-js-L1" rel="file-gistfile1-js-L1">1</span>
<span class="line-number" id="file-gistfile1-js-L2" rel="file-gistfile1-js-L2">2</span>
<span class="line-number" id="file-gistfile1-js-L3" rel="file-gistfile1-js-L3">3</span>
<span class="line-number" id="file-gistfile1-js-L4" rel="file-gistfile1-js-L4">4</span>
<span class="line-number" id="file-gistfile1-js-L5" rel="file-gistfile1-js-L5">5</span>
</td>
<td class="line-data">
<pre class="line-pre"><div class="line" id="file-gistfile1-js-LC1"><span class="nx">InstantClick</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span></div><div class="line" id="file-gistfile1-js-LC2"><span class="cm">/* or */</span></div><div class="line" id="file-gistfile1-js-LC3"><span class="nx">InstantClick</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span></div><div class="line" id="file-gistfile1-js-LC4"><span class="cm">/* or */</span></div><div class="line" id="file-gistfile1-js-LC5"><span class="nx">InstantClick</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="s1">&#39;mousedown&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span></div></pre>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>

<p>To whitelist a link, add it a <code>data-instant</code> attribute.

<div id="gist8879571" class="gist">
<div class="gist-file">
<div class="gist-data gist-syntax">
<div class="file-data">
<table cellpadding="0" cellspacing="0" class="lines highlight">
<tr>
<td class="line-numbers">
<span class="line-number" id="file-gistfile1-html-L1" rel="file-gistfile1-html-L1">1</span>
</td>
<td class="line-data">
<pre class="line-pre"><div class="line" id="file-gistfile1-html-LC1"><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;some-page.html&quot;</span> <span class="na">data-instant</span><span class="nt">&gt;</span>Link<span class="nt">&lt;/a&gt;</span></div></pre>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>

<h3 id="scripts">Dealing with scripts</h3>

<p>Besides the heavier load on your server, the real price to make your website instant is that you’ll have to revisit how your scripts are architectured. Because InstantClick makes your website a single-page application, there’s no <code>DOMContentLoaded</code> firing on page changes anymore.

<p>If you have a script in the <code>&lt;body&gt;</code> that you wish not to re-evaluate when InstantClick displays a page, add it a <code>data-no-instant</code> attribute.

<div id="gist8879571" class="gist">
<div class="gist-file">
<div class="gist-data gist-syntax">
<div class="file-data">
<table cellpadding="0" cellspacing="0" class="lines highlight">
<tr>
<td class="line-numbers">
<span class="line-number" id="file-gistfile1-html-L1" rel="file-gistfile1-html-L1">1</span>
</td>
<td class="line-data">
<pre class="line-pre"><div class="line" id="file-gistfile1-html-LC1"><span class="nt">&lt;script </span><span class="na">data-no-instant</span><span class="nt">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;I’m only run once.&quot;</span><span class="p">);</span><span class="nt">&lt;/script&gt;</span></div></pre>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>

<p>If you have a snippet of JavaScript that you need to execute on every page change, use the following:

<div id="gist8879571" class="gist">
<div class="gist-file">
<div class="gist-data gist-syntax">
<div class="file-data">
<table cellpadding="0" cellspacing="0" class="lines highlight">
<tr>
<td class="line-numbers">
<span class="line-number" id="file-gistfile1-js-L1" rel="file-gistfile1-js-L1">1</span>
</td>
<td class="line-data">
<pre class="line-pre"><div class="line" id="file-gistfile1-js-LC1"><span class="nx">InstantClick</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="nx">yourCallback</span><span class="p">);</span></div></pre>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>

<p>Call <code>InstantClick.on</code> before <code>InstantClick.init</code> so that it runs on initial page load (including when the browser doesn’t support pushState).

<hr>

<p>For an example, here’s how to make Google Analytics work:

<div id="gist8879571" class="gist">
<div class="gist-file">
<div class="gist-data gist-syntax">
<div class="file-data">
<table cellpadding="0" cellspacing="0" class="lines highlight">
<tr>
<td class="line-numbers">
<span class="line-number" id="file-gistfile1-html-L1" rel="file-gistfile1-html-L1">1</span>
<span class="line-number" id="file-gistfile1-html-L2" rel="file-gistfile1-html-L2">2</span>
<span class="line-number" id="file-gistfile1-html-L3" rel="file-gistfile1-html-L3">3</span>
<span class="line-number" id="file-gistfile1-html-L4" rel="file-gistfile1-html-L4">4</span>
<span class="line-number" id="file-gistfile1-html-L5" rel="file-gistfile1-html-L5">5</span>
<span class="line-number" id="file-gistfile1-html-L6" rel="file-gistfile1-html-L6">6</span>
<span class="line-number" id="file-gistfile1-html-L7" rel="file-gistfile1-html-L7">7</span>
<span class="line-number" id="file-gistfile1-html-L8" rel="file-gistfile1-html-L8">8</span>
<span class="line-number" id="file-gistfile1-html-L9" rel="file-gistfile1-html-L9">9</span>
<span class="line-number" id="file-gistfile1-html-L10" rel="file-gistfile1-html-L10">10</span>
</td>
<td class="line-data">
<pre class="line-pre"><div class="line" id="file-gistfile1-html-LC1"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;instantclick.min.js&quot;</span> <span class="na">data-no-instant</span><span class="nt">&gt;&lt;/script&gt;</span></div><div class="line" id="file-gistfile1-html-LC2"><span class="nt">&lt;script </span><span class="na">data-no-instant</span><span class="nt">&gt;</span></div><div class="line" id="file-gistfile1-html-LC3"><span class="cm">/* Google Analytics code here, without ga(&#39;send&#39;, &#39;pageview&#39;) */</span></div><div class="line" id="file-gistfile1-html-LC4">&nbsp;</div><div class="line" id="file-gistfile1-html-LC5"><span class="nx">InstantClick</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></div><div class="line" id="file-gistfile1-html-LC6">  <span class="nx">ga</span><span class="p">(</span><span class="s1">&#39;send&#39;</span><span class="p">,</span> <span class="s1">&#39;pageview&#39;</span><span class="p">,</span> <span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span> <span class="o">+</span> <span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">);</span></div><div class="line" id="file-gistfile1-html-LC7"><span class="p">});</span></div><div class="line" id="file-gistfile1-html-LC8">&nbsp;</div><div class="line" id="file-gistfile1-html-LC9"><span class="nx">InstantClick</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span></div><div class="line" id="file-gistfile1-html-LC10"><span class="nt">&lt;/script&gt;</span></div></pre>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>

<p>If you have other scripts conflicting with InstantClick, you might get an idea on how to solve the problem by checking the <a href="http://reed.github.io/turbolinks-compatibility/" target="_blank">Turbolinks Compatibility</a> site.
<script src="script-4.js" data-no-instant></script>
